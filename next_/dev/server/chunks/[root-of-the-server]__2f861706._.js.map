{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Users/seherulusoy/AURYN%20WEB%20SITE/src/auth.config.ts"],"sourcesContent":["import type { NextAuthConfig } from 'next-auth';\n\nexport const authConfig = {\n    pages: {\n        signIn: '/login',\n    },\n    providers: [\n        // Added later in auth.ts\n    ],\n    callbacks: {\n        async jwt({ token, user }) {\n            if (user) {\n                token.role = user.role;\n                token.id = user.id;\n            }\n            return token;\n        },\n        async session({ session, token }) {\n            if (session.user) {\n                session.user.role = token.role as string;\n                session.user.id = token.id as string;\n            }\n            return session;\n        },\n        async redirect({ url, baseUrl }) {\n            // Allows relative callback URLs\n            if (url.startsWith(\"/\")) return `${baseUrl}${url}`;\n            // Allows callback URLs on the same origin\n            else if (new URL(url).origin === baseUrl) return url;\n            return baseUrl;\n        },\n        authorized({ auth, request: { nextUrl } }) {\n            const isLoggedIn = !!auth?.user;\n            const isOnAdmin = nextUrl.pathname.startsWith('/admin');\n            if (isOnAdmin) {\n                if (isLoggedIn) return true;\n                return false; // Redirect unauthenticated users to login page\n            }\n            return true;\n        },\n    },\n} satisfies NextAuthConfig;\n"],"names":[],"mappings":";;;;AAEO,MAAM,aAAa;IACtB,OAAO;QACH,QAAQ;IACZ;IACA,WAAW,EAEV;IACD,WAAW;QACP,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACrB,IAAI,MAAM;gBACN,MAAM,IAAI,GAAG,KAAK,IAAI;gBACtB,MAAM,EAAE,GAAG,KAAK,EAAE;YACtB;YACA,OAAO;QACX;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,IAAI,QAAQ,IAAI,EAAE;gBACd,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;gBAC9B,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;YAC9B;YACA,OAAO;QACX;QACA,MAAM,UAAS,EAAE,GAAG,EAAE,OAAO,EAAE;YAC3B,gCAAgC;YAChC,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO,GAAG,UAAU,KAAK;iBAE7C,IAAI,IAAI,IAAI,KAAK,MAAM,KAAK,SAAS,OAAO;YACjD,OAAO;QACX;QACA,YAAW,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;YACrC,MAAM,aAAa,CAAC,CAAC,MAAM;YAC3B,MAAM,YAAY,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAC9C,IAAI,WAAW;gBACX,IAAI,YAAY,OAAO;gBACvB,OAAO,OAAO,+CAA+C;YACjE;YACA,OAAO;QACX;IACJ;AACJ"}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Users/seherulusoy/AURYN%20WEB%20SITE/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\nimport { withAccelerate } from '@prisma/extension-accelerate';\n\nconst prismaClientSingleton = () => {\n    return new PrismaClient({\n        log: ['query'],\n        // @ts-ignore\n        accelerateUrl: process.env.DATABASE_URL,\n    }).$extends(withAccelerate());\n};\n\ntype PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>;\n\nconst globalForPrisma = global as unknown as {\n    prisma: PrismaClientSingleton | undefined;\n};\n\nexport const prisma = globalForPrisma.prisma ?? prismaClientSingleton();\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma;\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,wBAAwB;IAC1B,OAAO,IAAI,6IAAY,CAAC;QACpB,KAAK;YAAC;SAAQ;QACd,aAAa;QACb,eAAe,QAAQ,GAAG,CAAC,YAAY;IAC3C,GAAG,QAAQ,CAAC,IAAA,wLAAc;AAC9B;AAIA,MAAM;AAIC,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 139, "column": 0}, "map": {"version":3,"sources":["file:///Users/seherulusoy/AURYN%20WEB%20SITE/src/auth.ts"],"sourcesContent":["import NextAuth from 'next-auth';\nimport { authConfig } from './auth.config';\nimport Credentials from 'next-auth/providers/credentials';\nimport { z } from 'zod';\nimport { prisma } from '@/lib/prisma';\nimport bcrypt from 'bcryptjs';\n\nasync function getUser(email: string) {\n    try {\n        const user = await prisma.user.findUnique({ where: { email } });\n        return user;\n    } catch (error) {\n        console.error('Failed to fetch user:', error);\n        throw new Error('Failed to fetch user.');\n    }\n}\n\nexport const { handlers, auth, signIn, signOut } = NextAuth({\n    ...authConfig,\n    trustHost: true,\n    providers: [\n        Credentials({\n            async authorize(credentials) {\n                console.log('Authorize called with:', { email: credentials?.email });\n                const parsedCredentials = z\n                    .object({ email: z.string().email(), password: z.string().min(4) })\n                    .safeParse(credentials);\n\n                if (parsedCredentials.success) {\n                    const { email, password } = parsedCredentials.data;\n                    console.log('Credentials parsed successfully for:', email);\n\n                    const user = await getUser(email);\n                    if (!user) {\n                        console.log('User not found in database.');\n                        return null;\n                    }\n                    console.log('User found:', { id: user.id, email: user.email, role: user.role });\n\n                    const passwordsMatch = await bcrypt.compare(password, user.passwordHash);\n                    console.log('Password match result:', passwordsMatch);\n\n                    if (passwordsMatch) return user;\n                } else {\n                    console.log('Credential validation failed:', parsedCredentials.error);\n                }\n                console.log('Invalid credentials');\n                return null;\n            },\n        }),\n    ],\n});\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;;;;;;;AAEA,eAAe,QAAQ,KAAa;IAChC,IAAI;QACA,MAAM,OAAO,MAAM,gIAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAC7D,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,MAAM,IAAI,MAAM;IACpB;AACJ;AAEO,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,GAAG,IAAA,kKAAQ,EAAC;IACxD,GAAG,qIAAU;IACb,WAAW;IACX,WAAW;QACP,IAAA,uKAAW,EAAC;YACR,MAAM,WAAU,WAAW;gBACvB,QAAQ,GAAG,CAAC,0BAA0B;oBAAE,OAAO,aAAa;gBAAM;gBAClE,MAAM,oBAAoB,oLAAC,CACtB,MAAM,CAAC;oBAAE,OAAO,oLAAC,CAAC,MAAM,GAAG,KAAK;oBAAI,UAAU,oLAAC,CAAC,MAAM,GAAG,GAAG,CAAC;gBAAG,GAChE,SAAS,CAAC;gBAEf,IAAI,kBAAkB,OAAO,EAAE;oBAC3B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,kBAAkB,IAAI;oBAClD,QAAQ,GAAG,CAAC,wCAAwC;oBAEpD,MAAM,OAAO,MAAM,QAAQ;oBAC3B,IAAI,CAAC,MAAM;wBACP,QAAQ,GAAG,CAAC;wBACZ,OAAO;oBACX;oBACA,QAAQ,GAAG,CAAC,eAAe;wBAAE,IAAI,KAAK,EAAE;wBAAE,OAAO,KAAK,KAAK;wBAAE,MAAM,KAAK,IAAI;oBAAC;oBAE7E,MAAM,iBAAiB,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,YAAY;oBACvE,QAAQ,GAAG,CAAC,0BAA0B;oBAEtC,IAAI,gBAAgB,OAAO;gBAC/B,OAAO;oBACH,QAAQ,GAAG,CAAC,iCAAiC,kBAAkB,KAAK;gBACxE;gBACA,QAAQ,GAAG,CAAC;gBACZ,OAAO;YACX;QACJ;KACH;AACL"}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///Users/seherulusoy/AURYN%20WEB%20SITE/src/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["import { handlers } from \"@/auth\" // Referring to @/auth.ts\nconst { GET, POST } = handlers\nexport { GET, POST }\n"],"names":[],"mappings":";;;;;;AAAA,+LAAkC,yBAAyB;;AAC3D,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,yHAAQ"}}]
}